<% if @user.access_locked? %>
  <div class="crayons-notice crayons-notice--danger py-2 pr-2 mb-3 flex justify-between items-center">
    <p class="flex-1 flex">
      <%= crayons_icon_tag(:lock, title: "Access locked", class: "mr-2") %>
      This user has locked access.
    </p>
    <%= link_to "Unlock access", unlock_access_admin_user_path(@user), method: :patch, class: "c-link c-link--block c-link--branded" %>
  </div>
<% end %>

<section class="crayons-card flex gap-6 mb-2 m:mb-3 m:p-7">
  <img src="<%= @user.profile_image_url_for(length: 192) %>" width="96" height="96" alt="<%= @user.name %> profile picture" class="radius-full bg-base-10">
  <div class="grid gap-2 flex-1">
    <div class="flex items-center">
      <div class="flex flex-1 items-center">
        <h1 class="crayons-title lh-tight">
          <%= @user.name %>
        </h1>
        <%= render "status" %>
      </div>
      <div class="flex gap-2">
        <%= link_to "Visit profile", @user.path, class: "c-cta", target: "_blank", rel: "noopener" %>
        <div class="relative dropdown-trigger-container">
          <button type="button" class="c-btn c-btn--icon-alone dropdown-trigger" id="options-dropdown-trigger" aria-haspopup="true" aria-expanded="false" aria-controls="options-dropdown">
            <%= crayons_icon_tag("overflow-vertical", title: "Options") %>
          </button>
          <div class="crayons-dropdown right-0" id="options-dropdown">
            <ul class="p-0">
              <% if @user.access_locked? %>
                <li><%= link_to "Unlock access", unlock_access_admin_user_path(@user), method: :patch, class: "c-link c-link--block" %></li>
              <% end %>
              <li><button type="button" class="c-btn w-100 align-left">Export data</button></li>
              <li><button type="button" class="c-btn w-100 align-left">Merge accounts</button></li>
              <% if @user.articles_count > 0 %>
                <li><button type="button" class="c-btn w-100 align-left">Unpublish all posts</button></li>
              <% end %>
              <% if @user.identities.any? %>
                <li><button type="button" class="c-btn w-100 align-left">Remove social account</button></li>
              <% end %>
              <li><button type="button" class="c-btn c-btn--destructive w-100 align-left">Banish for spam</button></li>
              <li><button type="button" class="c-btn c-btn--destructive w-100 align-left">Delete user</button></li>
            </ul>
          </div>
        </div>
      </div>
    </div>
    <div class="fs-s color-base-60 mb-1">
      @<%= @user.username %> &bull; <%= @user.id %> &bull;
      <% if @user.registered? %>
        Member since <%= @user.created_at.strftime("%b %e '%y") %>
      <% else %>
        @<%= @user.username %> has not accepted their invitation yet.
      <% end %>
    </div>
    <div>
      <ul class="flex gap-7 flex-wrap">
        <li>
          <a href="mailto:<%= @user.email %>" class="c-link c-link--icon-left inline-block" target="_blank">
            <%= crayons_icon_tag(:email, title: "Email", class: "c-link__icon") %>
            <%= @user.email %>
          </a>
        </li>
        <% if @user.github_username %>
          <li>
            <a href="https://github.com/<%= @user.github_username %>" class="c-link c-link--icon-left inline-block" target="_blank">
              <%= crayons_icon_tag(:github, title: "GitHub") %>
              <%= @user.github_username %>
            </a>
          </li>
        <% end %>
        <% if @user.twitter_username %>
          <li>
            <a href="https://twitter.com/<%= @user.twitter_username %>" class="c-link c-link--icon-left inline-block" target="_blank">
              <%= crayons_icon_tag(:twitter, title: "GitHub") %>
              <%= @user.twitter_username %>
            </a>
          </li>
        <% end %>
      </ul>
    </div>
  </div>
</section>
